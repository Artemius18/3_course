SELECT SCHEMA_NAME
FROM INFORMATION_SCHEMA.SCHEMATA

-- 6
SELECT TABLE_NAME, COLUMN_NAME, DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = 'dbo'


-- 7
select geometry_columns.srid as SRID from geometry_columns

-- 8
SELECT COLUMN_NAME, DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = 'dbo' AND DATA_TYPE != 'geometry'

-- 9.	Верните описания пространственных объектов в формате WKT
--  текстовый формат для представления геометрических объектов в пространстве
SELECT geom.STAsText() AS WKT_Description FROM [10m_cultural]

-- 10
select * from [10m_cultural];

-- 10.1.

SELECT obj1.geom.STIntersection(obj2.geom) AS Intersection
FROM [10m_cultural] obj1, [10m_cultural] obj2
WHERE obj1.qgs_fid = 1 AND obj2.qgs_fid = 1

-- 10.2.

SELECT geom.STPointN(1).ToString() AS VertexCoordinates
FROM [10m_cultural]
WHERE qgs_fid = 1

-- 10.3.	
SELECT geom.STArea() AS ObjectArea
FROM [10m_cultural]
WHERE qgs_fid = 5

-- 11.	
DECLARE @pointGeometry GEOMETRY;
SET @pointGeometry = GEOMETRY::STGeomFromText('POINT(5 7)', 0);
SELECT @pointGeometry AS PointGeometry;

DECLARE @lineGeometry GEOMETRY;
SET @lineGeometry = GEOMETRY::STGeomFromText('LINESTRING(1 7, 10 5)', 0);
SELECT @lineGeometry AS LineGeometry;


-- полигон
DECLARE @polygonGeometry GEOMETRY;
SET @polygonGeometry = GEOMETRY::STGeomFromText('POLYGON((1 1, 50 1, 50 50, 1 50, 1 1))', 0);
SELECT @polygonGeometry AS PolygonGeometry;


-- 12.	
DECLARE @polygon GEOMETRY = GEOMETRY::STGeomFromText('MULTIPOLYGON (((-179.02882208048163 -21.63896039933087, -179.97510099548126 -21.800520214086816, -179.97510099548126 -15.130407862016682, -178.82110231865249 -15.499687438601939, -177.71326358889687 -16.215166618235685, -177.09010430340936 -17.022965692015873, -176.76698467389735 -18.038484527625144, -176.92854448865336 -18.846283601405275, -177.89790337718949 -20.854241299087278, -179.02882208048163 -21.63896039933087)), ((169.24439537852129 -9.3136532531308376, 175.8752547535214 -10.885796807818394, 176.78553307383368 -11.164239190630951, 177.4401961597714 -11.524590753130838, 178.0467635425839 -12.050591729693394, 178.59315026133368 -12.683892510943451, 179.06714928477152 -13.365899346880894, 179.45691979258379 -14.038018487505951, 179.75025475352129 -14.641534112505894, 179.93494713633368 -15.117974542193451, 179.99940026133379 -15.408868096880894, 179.99940026133379 -15.505303643755894, 179.99940026133379 -18.426934503130951, 179.99940026133379 -19.440728448443394, 179.99940026133379 -19.519707940630838, 179.99940026133379 -20.635674737505894, 179.8985701832089 -20.754937432818451, 179.61719811289618 -21.073174737505951, 179.18628990977129 -21.531548760943394, 178.63721764414629 -22.071343682818394, 178.00147545664618 -22.633355401568394, 177.31006920664618 -23.158746026568338, 176.5944930347714 -23.588677667193451, 175.88599694102129 -23.864190362505838, 175.12403405039629 -24.077447198443451, 174.25464928477129 -24.369317315630894, 173.31971276133368 -24.754327081255894, 172.36036217539618 -25.246636651568338, 171.41858971445879 -25.860406182818338, 170.53565514414629 -26.610039971880951, 169.75318444102152 -27.509698175005838, 169.11268151133379 -28.573785089068394, 168.5310164722714 -29.483330987505838, 167.86329186289629 -29.917290948443451, 167.05787194102118 -29.886285089068451, 166.06336510508379 -29.400567315630951, 164.82813561289629 -28.470879815630894, 163.30079186289618 -27.107842706255951, 159.16431725352118 -23.123345635943394, 156.56763756602118 -20.757378839068394, 153.83594811289618 -18.502862237505951, 151.11548912852118 -16.421441339068451, 148.55237877695879 -14.575127862505951, 146.2926131519589 -13.025567315630838, 143.26807701914618 -11.064263604693338, 142.93210266422363 -10.859432946564482, 142.7955428394589 -10.776177667193451, 142.74390709727129 -10.741997979693338, 142.6942244800839 -10.697808526568394, 142.64515221445868 -10.652154229693338, 142.59485924570868 -10.612969659380838, 142.54212487070879 -10.588677667193451, 142.48548424570879 -10.587579034380894, 142.42335045664652 -10.617974542193451, 142.35450280039652 -10.687920831255838, 142.25879967539618 -10.773492120318451, 142.11451256602118 -10.844659112505951, 141.91761315195879 -10.901177667193338, 141.6644393238339 -10.942681573443451, 141.58477370982621 -10.949315208228427, 141.35071862070868 -10.968804620318451, 140.97291100352129 -10.979424737505894, 140.52674401133368 -10.974053643755951, 140.00855553477129 -10.952569268755838, 139.24695885508379 -10.844170831255951, 138.15272057383379 -10.606499932818338, 136.84449303477129 -10.281426690630894, 131.84742272227129 -8.9437802062559513, 131.2507430347714 -8.8093807921933376, 131.21090966499867 -8.8036220250204451, 130.8234969410214 -8.7476132140684513, 128.73977197968827 -8.49503480930656, 128.59954604228153 -8.2457442539164845, 128.38008450557982 -7.8381728286133807, 128.09791967267768 -7.4306014033105043, 127.86278231192591 -6.9916783299072449, 127.5022383587733 -6.4430244881530712, 127.06331528537009 -5.9727497666495992, 126.54601309171619 -5.5495025172966166, 126.21682078666379 -5.314365156544909, 125.82492518541096 -5.1105794438933572, 125.55843617655898 -4.8440904350414371, 125.35465046390743 -4.4992223059388152, 125.21356804745642 -4.1386783527862008, 125.18221639935621 -3.6997552793829414, 125.21784910967938 -3.477050839863864, 125.33038763544982 -3.1496660376221826, 125.49625058970685 -2.9469446490858786, 125.71740119538299 -2.799510911968639, 126.49142831524887 -2.6520771748512857,
126.63886205236611 -2.4493557863149817, 126.76786657234368 -2.2650636149181764, 126.86001265804214 -2.0992006606613245, 126.86001265804214 -1.7859039692870056, 126.82315422376269 -1.5278949293316941, 126.73100813806434 -1.3251735407953333, 126.52828674952809 -1.0671645008399651, 126.21499005815383 -0.62486328948807568, 126.04912710389681 -0.035128341018776148, 125.9938394524778 0.38874365319355775, 125.9938394524778 0.81261564740583481, 126.02902283001185 1.0659359656506808, 127.17615807383368 2.5941836609315487, 127.58423912852118 3.0332705749941056, 127.97486412852118 3.2097232117128556, 128.34815514414629 3.1685244812441056, 128.70411217539629 2.9546572937440487, 129.04273522227152 2.6130435242127987, 129.36402428477129 2.1886050476504124, 129.66785729258379 1.7263858093691056, 129.95435631602129 1.2712466492127987, 130.38465416758379 0.89935944218160557, 131.08582604258379 0.64246246952541242, 132.0058699878964 0.47919342655666242, 133.09290612070879 0.38819000858785557, 134.29529869883379 0.34802887577524189, 138.07703698008368 0.31873200077535557, 140.67208695286331 0.14070475545179306, 148.10474694102118 -0.36919524531845127, 150.1391707691464 -0.69573333125595127, 152.27515709727118 -1.3745663390684513, 154.45594323008379 -2.3113339171933376, 156.62427819102129 -3.4119198546933944, 162.48438561289629 -6.7531063781309513, 164.0327254566464 -7.5658505187557239, 165.58545983164618 -8.2087948546934513, 167.35731041758379 -8.7903378234434513, 169.24439537852129 -9.3136532531308376)))', 4326);
SELECT @polygon.STIntersection(geom) AS Intersection
FROM [10m_cultural]


-- 13.
create index Geometry_index on [10m_cultural](qgs_fid);

-- 14.

DECLARE @point GEOMETRY;
SET @point = GEOMETRY::STGeomFromText('POINT(150 -8)', 4326); 
EXEC PointCheckProc @point;


CREATE PROCEDURE PointCheckProc
@point GEOMETRY
AS
BEGIN
	DECLARE @polygon GEOMETRY = GEOMETRY::STGeomFromText('MULTIPOLYGON (((-179.02882208048163 -21.63896039933087, -179.97510099548126 -21.800520214086816, -179.97510099548126 -15.130407862016682, -178.82110231865249 -15.499687438601939, -177.71326358889687 -16.215166618235685, -177.09010430340936 -17.022965692015873, -176.76698467389735 -18.038484527625144, -176.92854448865336 -18.846283601405275, -177.89790337718949 -20.854241299087278, -179.02882208048163 -21.63896039933087)), ((169.24439537852129 -9.3136532531308376, 175.8752547535214 -10.885796807818394, 176.78553307383368 -11.164239190630951, 177.4401961597714 -11.524590753130838, 178.0467635425839 -12.050591729693394, 178.59315026133368 -12.683892510943451, 179.06714928477152 -13.365899346880894, 179.45691979258379 -14.038018487505951, 179.75025475352129 -14.641534112505894, 179.93494713633368 -15.117974542193451, 179.99940026133379 -15.408868096880894, 179.99940026133379 -15.505303643755894, 179.99940026133379 -18.426934503130951, 179.99940026133379 -19.440728448443394, 179.99940026133379 -19.519707940630838, 179.99940026133379 -20.635674737505894, 179.8985701832089 -20.754937432818451, 179.61719811289618 -21.073174737505951, 179.18628990977129 -21.531548760943394, 178.63721764414629 -22.071343682818394, 178.00147545664618 -22.633355401568394, 177.31006920664618 -23.158746026568338, 176.5944930347714 -23.588677667193451, 175.88599694102129 -23.864190362505838, 175.12403405039629 -24.077447198443451, 174.25464928477129 -24.369317315630894, 173.31971276133368 -24.754327081255894, 172.36036217539618 -25.246636651568338, 171.41858971445879 -25.860406182818338, 170.53565514414629 -26.610039971880951, 169.75318444102152 -27.509698175005838, 169.11268151133379 -28.573785089068394, 168.5310164722714 -29.483330987505838, 167.86329186289629 -29.917290948443451, 167.05787194102118 -29.886285089068451, 166.06336510508379 -29.400567315630951, 164.82813561289629 -28.470879815630894, 163.30079186289618 -27.107842706255951, 159.16431725352118 -23.123345635943394, 156.56763756602118 -20.757378839068394, 153.83594811289618 -18.502862237505951, 151.11548912852118 -16.421441339068451, 148.55237877695879 -14.575127862505951, 146.2926131519589 -13.025567315630838, 143.26807701914618 -11.064263604693338, 142.93210266422363 -10.859432946564482, 142.7955428394589 -10.776177667193451, 142.74390709727129 -10.741997979693338, 142.6942244800839 -10.697808526568394, 142.64515221445868 -10.652154229693338, 142.59485924570868 -10.612969659380838, 142.54212487070879 -10.588677667193451, 142.48548424570879 -10.587579034380894, 142.42335045664652 -10.617974542193451, 142.35450280039652 -10.687920831255838, 142.25879967539618 -10.773492120318451, 142.11451256602118 -10.844659112505951, 141.91761315195879 -10.901177667193338, 141.6644393238339 -10.942681573443451, 141.58477370982621 -10.949315208228427, 141.35071862070868 -10.968804620318451, 140.97291100352129 -10.979424737505894, 140.52674401133368 -10.974053643755951, 140.00855553477129 -10.952569268755838, 139.24695885508379 -10.844170831255951, 138.15272057383379 -10.606499932818338, 136.84449303477129 -10.281426690630894, 131.84742272227129 -8.9437802062559513, 131.2507430347714 -8.8093807921933376, 131.21090966499867 -8.8036220250204451, 130.8234969410214 -8.7476132140684513, 128.73977197968827 -8.49503480930656, 128.59954604228153 -8.2457442539164845, 128.38008450557982 -7.8381728286133807, 128.09791967267768 -7.4306014033105043, 127.86278231192591 -6.9916783299072449, 127.5022383587733 -6.4430244881530712, 127.06331528537009 -5.9727497666495992, 126.54601309171619 -5.5495025172966166, 126.21682078666379 -5.314365156544909, 125.82492518541096 -5.1105794438933572, 125.55843617655898 -4.8440904350414371, 125.35465046390743 -4.4992223059388152, 125.21356804745642 -4.1386783527862008, 125.18221639935621 -3.6997552793829414, 125.21784910967938 -3.477050839863864, 125.33038763544982 -3.1496660376221826, 125.49625058970685 -2.9469446490858786, 125.71740119538299 -2.799510911968639, 126.49142831524887 -2.6520771748512857,
	126.63886205236611 -2.4493557863149817, 126.76786657234368 -2.2650636149181764, 126.86001265804214 -2.0992006606613245, 126.86001265804214 -1.7859039692870056, 126.82315422376269 -1.5278949293316941, 126.73100813806434 -1.3251735407953333, 126.52828674952809 -1.0671645008399651, 126.21499005815383 -0.62486328948807568, 126.04912710389681 -0.035128341018776148, 125.9938394524778 0.38874365319355775, 125.9938394524778 0.81261564740583481, 126.02902283001185 1.0659359656506808, 127.17615807383368 2.5941836609315487, 127.58423912852118 3.0332705749941056, 127.97486412852118 3.2097232117128556, 128.34815514414629 3.1685244812441056, 128.70411217539629 2.9546572937440487, 129.04273522227152 2.6130435242127987, 129.36402428477129 2.1886050476504124, 129.66785729258379 1.7263858093691056, 129.95435631602129 1.2712466492127987, 130.38465416758379 0.89935944218160557, 131.08582604258379 0.64246246952541242, 132.0058699878964 0.47919342655666242, 133.09290612070879 0.38819000858785557, 134.29529869883379 0.34802887577524189, 138.07703698008368 0.31873200077535557, 140.67208695286331 0.14070475545179306, 148.10474694102118 -0.36919524531845127, 150.1391707691464 -0.69573333125595127, 152.27515709727118 -1.3745663390684513, 154.45594323008379 -2.3113339171933376, 156.62427819102129 -3.4119198546933944, 162.48438561289629 -6.7531063781309513, 164.0327254566464 -7.5658505187557239, 165.58545983164618 -8.2087948546934513, 167.35731041758379 -8.7903378234434513, 169.24439537852129 -9.3136532531308376)))', 4326);
    
    IF @point.STWithin(@polygon) = 1
    BEGIN
        SELECT @polygon AS Polygon;
    END
    ELSE
    BEGIN
        SELECT NULL AS Polygon;
    END
END;


DECLARE @polygonGeometry GEOMETRY;
SET @polygonGeometry = GEOMETRY::STGeomFromText('MULTIPOLYGON (((-179.02882208048163 -21.63896039933087, -179.97510099548126 -21.800520214086816, -179.97510099548126 -15.130407862016682, -178.82110231865249 -15.499687438601939, -177.71326358889687 -16.215166618235685, -177.09010430340936 -17.022965692015873, -176.76698467389735 -18.038484527625144, -176.92854448865336 -18.846283601405275, -177.89790337718949 -20.854241299087278, -179.02882208048163 -21.63896039933087)), ((169.24439537852129 -9.3136532531308376, 175.8752547535214 -10.885796807818394, 176.78553307383368 -11.164239190630951, 177.4401961597714 -11.524590753130838, 178.0467635425839 -12.050591729693394, 178.59315026133368 -12.683892510943451, 179.06714928477152 -13.365899346880894, 179.45691979258379 -14.038018487505951, 179.75025475352129 -14.641534112505894, 179.93494713633368 -15.117974542193451, 179.99940026133379 -15.408868096880894, 179.99940026133379 -15.505303643755894, 179.99940026133379 -18.426934503130951, 179.99940026133379 -19.440728448443394, 179.99940026133379 -19.519707940630838, 179.99940026133379 -20.635674737505894, 179.8985701832089 -20.754937432818451, 179.61719811289618 -21.073174737505951, 179.18628990977129 -21.531548760943394, 178.63721764414629 -22.071343682818394, 178.00147545664618 -22.633355401568394, 177.31006920664618 -23.158746026568338, 176.5944930347714 -23.588677667193451, 175.88599694102129 -23.864190362505838, 175.12403405039629 -24.077447198443451, 174.25464928477129 -24.369317315630894, 173.31971276133368 -24.754327081255894, 172.36036217539618 -25.246636651568338, 171.41858971445879 -25.860406182818338, 170.53565514414629 -26.610039971880951, 169.75318444102152 -27.509698175005838, 169.11268151133379 -28.573785089068394, 168.5310164722714 -29.483330987505838, 167.86329186289629 -29.917290948443451, 167.05787194102118 -29.886285089068451, 166.06336510508379 -29.400567315630951, 164.82813561289629 -28.470879815630894, 163.30079186289618 -27.107842706255951, 159.16431725352118 -23.123345635943394, 156.56763756602118 -20.757378839068394, 153.83594811289618 -18.502862237505951, 151.11548912852118 -16.421441339068451, 148.55237877695879 -14.575127862505951, 146.2926131519589 -13.025567315630838, 143.26807701914618 -11.064263604693338, 142.93210266422363 -10.859432946564482, 142.7955428394589 -10.776177667193451, 142.74390709727129 -10.741997979693338, 142.6942244800839 -10.697808526568394, 142.64515221445868 -10.652154229693338, 142.59485924570868 -10.612969659380838, 142.54212487070879 -10.588677667193451, 142.48548424570879 -10.587579034380894, 142.42335045664652 -10.617974542193451, 142.35450280039652 -10.687920831255838, 142.25879967539618 -10.773492120318451, 142.11451256602118 -10.844659112505951, 141.91761315195879 -10.901177667193338, 141.6644393238339 -10.942681573443451, 141.58477370982621 -10.949315208228427, 141.35071862070868 -10.968804620318451, 140.97291100352129 -10.979424737505894, 140.52674401133368 -10.974053643755951, 140.00855553477129 -10.952569268755838, 139.24695885508379 -10.844170831255951, 138.15272057383379 -10.606499932818338, 136.84449303477129 -10.281426690630894, 131.84742272227129 -8.9437802062559513, 131.2507430347714 -8.8093807921933376, 131.21090966499867 -8.8036220250204451, 130.8234969410214 -8.7476132140684513, 128.73977197968827 -8.49503480930656, 128.59954604228153 -8.2457442539164845, 128.38008450557982 -7.8381728286133807, 128.09791967267768 -7.4306014033105043, 127.86278231192591 -6.9916783299072449, 127.5022383587733 -6.4430244881530712, 127.06331528537009 -5.9727497666495992, 126.54601309171619 -5.5495025172966166, 126.21682078666379 -5.314365156544909, 125.82492518541096 -5.1105794438933572, 125.55843617655898 -4.8440904350414371, 125.35465046390743 -4.4992223059388152, 125.21356804745642 -4.1386783527862008, 125.18221639935621 -3.6997552793829414, 125.21784910967938 -3.477050839863864, 125.33038763544982 -3.1496660376221826, 125.49625058970685 -2.9469446490858786, 125.71740119538299 -2.799510911968639, 126.49142831524887 -2.6520771748512857,
126.63886205236611 -2.4493557863149817, 126.76786657234368 -2.2650636149181764, 126.86001265804214 -2.0992006606613245, 126.86001265804214 -1.7859039692870056, 126.82315422376269 -1.5278949293316941, 126.73100813806434 -1.3251735407953333, 126.52828674952809 -1.0671645008399651, 126.21499005815383 -0.62486328948807568, 126.04912710389681 -0.035128341018776148, 125.9938394524778 0.38874365319355775, 125.9938394524778 0.81261564740583481, 126.02902283001185 1.0659359656506808, 127.17615807383368 2.5941836609315487, 127.58423912852118 3.0332705749941056, 127.97486412852118 3.2097232117128556, 128.34815514414629 3.1685244812441056, 128.70411217539629 2.9546572937440487, 129.04273522227152 2.6130435242127987, 129.36402428477129 2.1886050476504124, 129.66785729258379 1.7263858093691056, 129.95435631602129 1.2712466492127987, 130.38465416758379 0.89935944218160557, 131.08582604258379 0.64246246952541242, 132.0058699878964 0.47919342655666242, 133.09290612070879 0.38819000858785557, 134.29529869883379 0.34802887577524189, 138.07703698008368 0.31873200077535557, 140.67208695286331 0.14070475545179306, 148.10474694102118 -0.36919524531845127, 150.1391707691464 -0.69573333125595127, 152.27515709727118 -1.3745663390684513, 154.45594323008379 -2.3113339171933376, 156.62427819102129 -3.4119198546933944, 162.48438561289629 -6.7531063781309513, 164.0327254566464 -7.5658505187557239, 165.58545983164618 -8.2087948546934513, 167.35731041758379 -8.7903378234434513, 169.24439537852129 -9.3136532531308376)))', 4326);
SELECT @polygonGeometry AS PolygonGeometry;